= Maven 
劉育辰 <torr@tist.com.tw>
v2.1, 2019-10-08
:experimental:
:icons: font
:sectnums:
:imagesdir: images/
:toc: left
:toc-title: Outline
:sectanchors:

== What is Maven?

=== Maven

* Yiddish word(meyvn) meaning accumulator of knowledge
* software project management and comprehension tool

=== POM (Project Object Model)

* XML representation of a Maven project

.Basics
----
<?xml version="1.0" encoding="UTF-8"?>
<project xmlns="http://maven.apache.org/POM/4.0.0"
         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">
    <modelVersion>4.0.0</modelVersion>

    <groupId>com.tist</groupId>
    <artifactId>maven-origin</artifactId>
    <version>1.0-SNAPSHOT</version>

</project>
----

.Overview
----
<project xmlns="http://maven.apache.org/POM/4.0.0"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://maven.apache.org/POM/4.0.0
                      http://maven.apache.org/xsd/maven-4.0.0.xsd">
  <modelVersion>4.0.0</modelVersion>
 
  <!-- The Basics -->
  <groupId>...</groupId>
  <artifactId>...</artifactId>
  <version>...</version>
  <packaging>...</packaging>
  <dependencies>...</dependencies>
  <parent>...</parent>
  <dependencyManagement>...</dependencyManagement>
  <modules>...</modules>
  <properties>...</properties>
 
  <!-- Build Settings -->
  <build>...</build>
  <reporting>...</reporting>
 
  <!-- More Project Information -->
  <name>...</name>
  <description>...</description>
  <url>...</url>
  <inceptionYear>...</inceptionYear>
  <licenses>...</licenses>
  <organization>...</organization>
  <developers>...</developers>
  <contributors>...</contributors>
 
  <!-- Environment Settings -->
  <issueManagement>...</issueManagement>
  <ciManagement>...</ciManagement>
  <mailingLists>...</mailingLists>
  <scm>...</scm>
  <prerequisites>...</prerequisites>
  <repositories>...</repositories>
  <pluginRepositories>...</pluginRepositories>
  <distributionManagement>...</distributionManagement>
  <profiles>...</profiles>
</project>
----

IMPORTANT: There should be a single POM file for each project.

=== Maven Coordinates

* groupId
** This is generally unique amongst an organization or a project.

* artifactId
** This is generally the name that the project is known by.

* version
** This is the last piece of the naming puzzle.

perform -> [groupId] : [artifactId] : [version] +
example -> com.tist : mgov-core : 1.0.16-SNAPSHOT

[NOTE]
====
The three elements given above point to a specific version of a project, letting Maven know who we are dealing with, and when in its software lifecycle we want them.
====

=== Dependencies

----
<dependency>
    <groupId>com.tist</groupId>
    <artifactId>mgov-core</artifactId>
    <version>1.0.16-SNAPSHOT</version>
</dependency>
----

=== Repository

* Local
** directory on the computer where Maven runs.
** caches remote downloads and contains temporary build artifacts that you have not yet released.
* Remote
** any other type of repository.
** set up by a third party to provide their artifacts for downloading.

=== SNAPSHOT, RELEASE

* SNAPSHOT
** unstable, developing version

* RELEASE
** develop finished, deploy version

== What does Maven do?

* Parse command line
* Manage classpath
* Parse POM file
* Download Maven plugins as needed

NOTE: It delegates all of this work to Maven plugins.

=== Plugin & Goals

A plugin is a collection of one or more goals +
A goal is a “unit of work” in Maven

.plugin & goals
[[image-hard-status-select]]
image::maven/plugin&goals.png[plugin&goals]

perform -> [pluginId] : [goalId] +
example -> archetype : create.

=== Lifecycle Phases

Lifecycle is an ordered sequence of phases involved in building a project. +
Plugin goals can be attached to a lifecycle phase. +

.phases & goals
image::maven/phases&goals.png[phases&goals]

.Basic
. validate +
Validates whether project is correct and all necessary information is available to complete the build process.
. compile +
    Compile the source code of the project.
. test +
    Run tests using a suitable unit testing framework (Junit is one).
. package +
    Take the compiled code and package it in its distributable format, such as a JAR, WAR, or EAR file.
. verify +
    Run any check-ups to verify the package is valid and meets quality criteria.
. install +
    Install the package into the local repository, which can be used as a dependency in other projects locally.
. deploy +
    Copies the final package to the remote repository for sharing with other developers and projects.

.Clean Lifecycle
* clean +
  Remove all files generated by the previous build.

.Site Lifecycle
* site +
  Generate the project's site documentation.

.Default Lifecycle
. *validate*
. initialize
. generate-sources
. process-sources
. generate-resources
. process-resources
. *compile*
. process-classes
. generate-test-sources
. process-test-sources
. test-compile
. process-test-classes
. *test*
. prepare-package
. *package*
. pre-integration-test
. integration-test
. post-integration-test
. *verify*
. *install*
. *deploy*

NOTE: Executing a phase will first execute all proceeding phases in order, ending with the phase specified on the command line.

.A lifecycle is a sequence of phases
image::maven/lifecyclePhases.png[lifecyclePhases]
.Bound goals are run when their phases execute
image::maven/phases&goals2.png[phases&goals2]

== Transfer Traditional Project to Maven Project

=== What differences between Maven Project and non-Maven Project

. project structure
. POM file

image::maven/javaee&maven.png[javaee&maven]

=== e2m-convert tool

link:link/maven/eclipse2maven.html[e2m-convert]

== Continue Learning

* Gradle, Ant, Maven
* Spring Framework
* Anything you interested

